---
title: JS-Event-Loof 이벤트 루프에 대해서
date: 2022-07-18
description: JS-Event-Loof 이벤트 루프에 대해서
tags:
  - JS
  - 브라우저
---

자바스크립트는 싱글 스래드 프로그래밍 언어다. 하나의 싱글 콜 스택만 가지고 있다는 뜻이다.

풀어 말하면 JS는 한번에 한 작업만 할 수 있다는 말이다. (그것이 rendering일 수도 있고 JS 계산일 수도 있다.)

그렇다면 setTimeout과 같은 함수는 어떻게 작동하는걸까? 한번에 한 작업만 가능하다고 한다면 설정된 시간동안 아무 업무를 못해야하는 것이 아닌가?

이를 해결하기 위해서 사용되는 것이 이벤트 루프다.


![출처:https://codenotcode.com/my-event-loop-beebef81cd46](./image1.png)

출처:https://codenotcode.com/my-event-loop-beebef81cd46

### 이벤트 루프

JS의 콜스택은 기본적으로 LIFO 방식을 따른다.
만약 콜스택에 무한으로 돌아가는 함수가 있어 블로킹이 생기면 추가적인 작업이 불가능하다는 말이다.

JS는 앞서말했듯이 처리해야하는 코드를 보면 스택에 하나씩 쌓은 후 LIFO 방식으로 처리해나간다.

만약 비동기적인 요청이 들어오게 되면 어떻게 될 것인가?
이는 브라우저나 node에서 처리한 후 Callback queue에 저장한다.
즉, 브라우저는 CB 함수의 실행 시기를 정할 수 있다는 뜻이다.

비동기적인 이벤트의 대표적인 예로는 setTime 관련 함수들과 addEventListender을 통한 이벤트 함수들이 대표적일 것이다.

그렇다면 콜백 큐에 쌓인 함수는 어떻게 실행될 것인가?

기존에 콜 스택에 쌓여 있는 스택들에 무작정 올려버리면 당연히 소스의 실행에 장애가 생길 것이다.

여기서 작동하는 것이 이벤트 루프다.

이벤트 루프는 콜 스택의 스택 처리가 완료되면 콜백 큐에서 처리해야할 일을 하나씩 콜백 스택으로 옮겨 작업을 실행한다.

즉, 이벤트 루프의 주된 작업은 항상 콜 스택과 콜백 큐를 지켜보다가 콜백 큐의 작업을 스택 큐로 옮겨서 진행할 수 있도록 하는 것이다.




### 알아주면 좋을 것

CPU의 브라우저 계산은 매우 빠른 속도로 일어나게 될 것이다. 매번 반복되는 JS가 있을 경우 그 속도 또한 매우 빠를 것이다. 하지만 브라우저의 이상적인 렌더링 시기는 60프레임으로
만약 별도의 처리를 하지 않고 이벤트를 계속 반복 발생 시키게 된다면 불필요한 리소스를 잡아먹게 되는 것이다.
이를 보조하기 위해서 사용되는 것이  Request Animation Frame이다.

requestAnimationFrame을 이용하면 렌더링 전, 후(브라우저마다 다르다)에 JS가 실행되어 함수의 드리프트와 블로킹을 방지할 수 있다.


---

궁금한 점: 렌더링의 속성이나 값을 변경시키는 부분을 사용할 때 RAF를 이용하면 좋겠다는 생각이 많이 들었다. 다른 경우도 있을까?

---


[참조1](https://www.youtube.com/watch?v=8aGhZQkoFbQ)
[참조2](https://www.youtube.com/watch?v=cCOL7MC4Pl0)
