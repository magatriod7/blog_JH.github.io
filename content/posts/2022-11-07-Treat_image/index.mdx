---
title: 이미지 다루기
date: 2022-11-07
description: 이미지 다루기
tags:
---

이미지를 효율적으로 다룰 수 있는 방법

1. 이미지 압축

사실 저희가 사용하는 이미지들은 생각보다 불필요할정도로 큰 리소스를 잡아먹고 있을지도 모릅니다. 휴대폰 카메라가 발전하면서 그런 경향이 점점 더 커지고 있죠.

아래 아주 간단한 이미지 리사이징 예시입니다.

각 3장의 사진은 그림판으로 리사이징한 사진들입니다.

고작 그림판으로 리사이징을 했는데도 그 차이를 알아보기 힘든 점에서 얼마나 저희가 불필요한 리소스를 낭비하고 있는지 체감 되시나요?

이제 프론트엔드 개발자답게 좀 더 현명한 방법으로 이미지를 다루는 방법을 이야기해봅시다.

가장 대표적인 방법으로는 웹팩을 이용하는 것입니다. image-webpack-loader을 이용하면 이미지를 쉽게 처리할 수 있습니다.

```
module: {
 rules: [
   {
     test: /\.(png|jpg|jpeg|gif|webp)$/i,
     loader: 'image-webpack-loader',
     enforce: 'pre',
   },
 ]
}
```

2. 반응형 이미지 제공

두번쨰 방법은 반응형 이미지를 제공하는 것입니다. 반응형 이미지를 설정하는 대표적인 두가지 방법이 있습니다.

첫번째 방법은 media query를 이용하여 viewport에 따라 다른 이미지를 내보이는 방법입니다.

두번째 방법은 img 태그의 srcset 속성을 사용하는 것입니다.

```
<img
 src="img_example.jpg"
 srcset="
 1000px.jpg 1000w
 2000px.jpg 2000w
 3000px.jpg 3000w
 "
>
```

src 속성은 mediaquery왜 비슷합니다. 위의 예시에서는 적혀 있지 않지만 img 내부의 size는 기본적으로 100vw가 지정되어 있습니다. 예를들면 viewport의 width가 1920px이면 size는 1920px을 말하게 되겠네요.

이제 img 태그는 size를 기준으로하여 어떤 이미지를 내보일지를 정하게 됩니다.

위의 경우에서 1000/1920 은 1보다 작으므로 1000px.jpg는 적합하지 않다고 판단 후 2000/1920이 1 이상의 값을 가지므로 결국 렌더링 되는 것은 2000px.jpg가 될 것입니다.

여기서 size가 10vw로 바뀌면 기준이 1920px에서 192px로 달라지게 되어 1000/192가 되어 1보다 크기 때문에 1000px.jpg가 렌더링 될 것입니다.

분명 유용해보이지만 srcset속성은 안타깝게도 viewport의 크기에 좌우되는 것이 아닌 현재 사용자가 사용하고 있는 기기의 영향을 많이 받게 됩니다. Retina는 기본 기기보다 pixel이 두배 이상 세밀함을 보여줍니다.

즉, 일반 브라우저에서 1920px로 나타나던 화면도 Retina 환경에서는 그 두배 이상인 3840px 이상의 값을 가지게 되어 저희가 원하는 srcset의 값이 나오지 않을수도 있게 됩니다.

3. 이미지 loading 속성

이미지 크기도 줄였고 반응형 이미지도 적용했을 경우 이미지 최적화를 위해 할 수 있는 것이 또 무엇이 있을까요?

바로 img 태그의 loading 속성을 사용하는 것입니다.

loading

auto: 기본 지연 로딩 동작

lazy: 뷰포트에 근접한 이미지 리소스를 로딩

eager: 페이지에서의 위치에 관계없이 즉시 로딩

많은 이미지를 로딩할 경우 모든 이미지를 로딩할 필요 없이 뷰포트이 보일 필요한 이미지만 보여도 될 것입니다. 이 경우 img 태그에 loading="lazy" 속성을 추가하여 해결할 수 있습니다.

단, 이미지 로딩으로 인한 CLS(Cumulative Lay Shift, 누적 레이아웃 이동)이 생겨 레이아웃의 변화가 사용자의 이용에 불편을 줄 수 있기 때문에 기존 이미지의 사이즈를 설정해 줄 필요가 있습니다.

4. 올바른 이미지 확장자 사용

사실 이부분을 먼저 말해야하지 않았나 싶습니다. 여러분도 아시겠지만 이미지의 확장자의 종류는 제법 많습니다. 그 중 대표적으로 사용하는 것으로는 JPG, JPEG, PNG, SVG, Webp정도가 있습니다.

각자 특징을 간단하게 설명해보겠습니다.

Jpg, Jpeg(이름만 다르지 같습니다.): PNG에 비해서 뛰어난 압축률을 가지고 있지만 파일이 훼손될 수도 있습니다.

Png: 원본파일이 훼손되지 않고 투명 배경을 사용할 수 있습니다.

Gif: 여러장의 이미지를 한 파일에 담을 수 있어 흔히 말하는 움짤이라는 형식으로 데이터를 저장할 수 있습니다. 하지만 차지하는 용량이 많고 이미지를 256색상으로 변환해야하는 과정이 있어 원본을 훼손하게 됩니다.

WebP: webP는 기존 Gif, Jpg, Png의 장점을 모두 가지고 있습니다. 위 모든 파일보다 그 압축률이 뛰어나며 PNG파일에서 사용되는 투명 배경도 사용할 수 있습니다. 심지어 움직이는 이미지로도 활용이 가능해집니다.

완벽해보이지만.... 아무래도 최신 브라우저에서만 사용이 가능합니다. 물론 2020년 이후 대부분의 웹 브라우저가 지원은 하고 있습니다.

SVG: SVG는 위의 이미지들과 같이 픽셀의 정보를 저장하고 있는 것이아닌 전체적인 vertor의 정보를 이용해서 이미지를 나타냅니다.

이로 안해 크기를 줄이고 늘리고에 따라서 해상도가 변하지 않는 장점을 가지고 있습니다. 기본적으로 img 파일들보다 그 용량이 적습니다.

하지만 전문 소프트웨어나 작업이 없을 경우 제작하기가 어렵다는 단점이 있습니다.

5. 애니메이션 GIF를 비디오로 대체

움직이는 사진을 사용하고 싶은 경우 GIF 확장자가 아무래도 익숙할 것입니다.

하지만 GIF가 오래된 확장자인만큼 Webm이나 mp4와 같은 형식으로 대체하여 사용하는 것이 더 적은 리소스를 차지합니다.

---

[참고1](https://codingmoondoll.tistory.com/entry/%ED%94%84%EB%A1%A0%ED%8A%B8%EC%97%94%EB%93%9C-%EC%84%B1%EB%8A%A5-%EC%B5%9C%EC%A0%81%ED%99%94-4-%EC%9D%B4%EB%AF%B8%EC%A7%80-%ED%8C%8C%EC%9D%BC-%EC%B5%9C%EC%A0%81%ED%99%94)

[참고2](https://codingcoding.tistory.com/386)

[참고3](https://web.dev/i18n/ko/uses-optimized-images/)

[참고4](https://web.dev/replace-gifs-with-videos/)
